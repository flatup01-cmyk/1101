# 動画解析による選手データベース構築ガイド（完全版）

## 目的
各選手のスタイル、癖、パンチの角度、キックのフォームなどの詳細な技術的特徴を、動画解析ソフトを使って抽出し、データベースに登録する。**特に、ユーザーの動画解析結果と比較して「この動きは誰々に似ている」「この動きは誰々を目指している」と判断できるレベルの詳細なデータを構築する。**

## 推奨される動画解析ツール

### 1. Difyの動画解析機能（推奨）
- **メリット**：既にDifyを使用しているため、統合が容易
- **使い方**：Difyの動画解析機能に選手の試合動画をアップロードし、技術的特徴を分析させる
- **プロンプト例**：詳細なプロンプトは後述

### 2. OpenAI GPT-4 Vision（推奨）
- **メリット**：高精度な動画解析が可能
- **使い方**：OpenAI APIを使用して、動画のフレームを抽出し、GPT-4 Visionで分析
- **注意点**：動画をフレーム単位で解析する必要がある

### 3. Claude（Anthropic）
- **メリット**：長文の分析が得意
- **使い方**：Claude APIを使用して、動画のフレームを抽出し、分析

### 4. その他の動画解析API
- Google Cloud Video Intelligence API
- AWS Rekognition Video
- Azure Video Analyzer

## 動画解析の手順

### ステップ1：動画の準備
1. **動画の選定**
   - 各選手の代表的な試合動画を選定
   - 技術がよく見える角度の動画を選ぶ（正面、横、上からの角度が理想）
   - 複数の試合から、様々な技術が確認できる動画を選ぶ
   - **重要**：同じ動きを複数の角度から撮影した動画があると、より正確な分析が可能

2. **動画の前処理（重要）**
   - 動画を短いセグメントに分割（各セグメント10-30秒程度）
   - **重要なシーンを抽出**：
     - パンチを打つ瞬間（開始から終了まで）
     - キックを打つ瞬間（開始から終了まで）
     - 防御の瞬間（開始から終了まで）
     - フットワークの動き（連続した動き）
     - コンビネーション（開始から終了まで）
   - 動画の品質を確認（解像度、音声など）
   - **タイムスタンプを記録**：各シーンのタイムスタンプを記録し、後で参照できるようにする

### ステップ2：動画解析の実行

**Difyを使用する場合：**
1. Difyの動画解析機能に動画をアップロード
2. 以下の詳細プロンプトを使用して解析：

```
この動画の格闘家の技術的特徴を、ユーザーの動画解析結果と比較できるレベルで詳細に分析してください。

以下の項目について、動画の具体的なシーンを参照しながら、数値化できるものは数値で、比較可能なものは比較可能な形で記述してください：

## 1. スタンスの詳細分析

### 基本スタンス
- **スタンスの種類**：[オーソドックス/サウスポー/その他]
- **スタンスの幅**：[具体的な数値、例：肩幅の1.2倍、約60cmなど]
- **重心の位置**：[前足に何%の体重/後足に何%の体重、例：前足60%、後足40%]
- **スタンスの角度**：[前足の角度、後足の角度、例：前足45度、後足90度]
- **スタンスの高さ**：[膝の曲がり具合、例：膝が約30度曲がっている]

### スタンスの動き方
- **前進時のスタンス変化**：[具体的な記述、例：前足を約30cm前に出し、後足を約20cm前に出す]
- **後退時のスタンス変化**：[具体的な記述、例：後足を約30cm後ろに引き、前足を約20cm後ろに引く]
- **左右への動き**：[具体的な記述、例：左にステップする際は、左足を約40cm左に移動し、右足を約30cm左に移動]

### スタンスの特徴的な動き
- **攻撃前のスタンス変化**：[具体的な記述、例：パンチを打つ前に、前足に体重を70%移動させる]
- **防御前のスタンス変化**：[具体的な記述、例：防御する前に、後足に体重を60%移動させる]
- **特徴的な癖**：[具体的な記述、例：常に左足を少し前に出す癖がある]

## 2. パンチの詳細分析

### ストレート
- **軌道**：[直線的/アッパー気味/ダウン気味、具体的な角度、例：水平から約8度上向き]
- **角度**：[具体的な角度、例：水平から約8度上向き、体の中心線から約5度右]
- **スピード**：[具体的な数値または比較、例：0.15秒で打ち抜く、平均的なストレートの1.3倍の速度]
- **威力**：[具体的な数値または比較、例：体重の1.5倍の力で打つ、平均的なストレートの1.2倍の威力]
- **体重移動**：[具体的な記述、例：前足に体重を70%移動させ、腰を約15度回転させる]
- **腕の軌道**：[具体的な記述、例：肩から約45度の角度で前方に伸ばす]
- **手首の角度**：[具体的な記述、例：手首を約10度下向きに曲げる]
- **特徴的な動き**：[具体的な記述、例：ストレートを打つ前に、わずかに頭を下げる癖がある]

### フック
- **軌道**：[水平/アッパー気味/ダウン気味、具体的な角度、例：水平から約12度上向き]
- **角度**：[具体的な角度、例：体の中心線から約90度横、水平から約12度上向き]
- **スピード**：[具体的な数値または比較、例：0.18秒で打ち抜く、平均的なフックの1.2倍の速度]
- **威力**：[具体的な数値または比較、例：体重の1.8倍の力で打つ、平均的なフックの1.3倍の威力]
- **体重移動**：[具体的な記述、例：腰を約30度回転させ、前足に体重を65%移動させる]
- **腕の軌道**：[具体的な記述、例：肘を約90度曲げ、肩から約90度の角度で横に振る]
- **手首の角度**：[具体的な記述、例：手首を約15度下向きに曲げる]
- **特徴的な動き**：[具体的な記述、例：フックを打つ際に、腰を大きく回転させる癖がある]

### アッパーカット
- **軌道**：[垂直/斜め、具体的な角度、例：垂直から約10度前傾]
- **角度**：[具体的な角度、例：体の中心線から約15度前、垂直から約10度前傾]
- **スピード**：[具体的な数値または比較、例：0.20秒で打ち抜く、平均的なアッパーカットの1.1倍の速度]
- **威力**：[具体的な数値または比較、例：体重の1.6倍の力で打つ、平均的なアッパーカットの1.2倍の威力]
- **体重移動**：[具体的な記述、例：前足に体重を75%移動させ、腰を約20度回転させる]
- **腕の軌道**：[具体的な記述、例：肘を約60度曲げ、下から上に約80度の角度で打つ]
- **手首の角度**：[具体的な記述、例：手首を約5度上向きに曲げる]
- **特徴的な動き**：[具体的な記述、例：アッパーカットを打つ際に、体を少し前に傾ける癖がある]

### コンビネーション
- **よく使うコンビネーション**：[具体的な記述、例：1-2-3（ストレート→ストレート→フック）、各パンチの間隔は約0.2秒]
- **コンビネーションのスピード**：[具体的な数値、例：3発のコンビネーションを0.6秒で打つ]
- **コンビネーションの精度**：[具体的な数値または比較、例：コンビネーションの命中率は約85%]
- **コンビネーションの特徴**：[具体的な記述、例：最初のパンチで距離を詰め、2発目で相手のガードを崩し、3発目で決める]

## 3. キックの詳細分析

### フロントキック
- **フォーム**：[具体的な記述、例：膝を約90度曲げ、約45度の角度で前方に突き出す]
- **角度**：[具体的な角度、例：水平から約45度上向き、体の中心線から約5度右]
- **スピード**：[具体的な数値または比較、例：0.25秒で打ち抜く、平均的なフロントキックの1.2倍の速度]
- **威力**：[具体的な数値または比較、例：体重の1.3倍の力で打つ、平均的なフロントキックの1.1倍の威力]
- **体重移動**：[具体的な記述、例：前足に体重を80%移動させ、後足でバランスを取る]
- **脚の軌道**：[具体的な記述、例：膝を約90度曲げ、約45度の角度で前方に突き出す]
- **特徴的な動き**：[具体的な記述、例：フロントキックを打つ際に、体を少し後ろに傾ける癖がある]

### ミドルキック
- **フォーム**：[具体的な記述、例：膝を約90度曲げ、腰を約45度回転させ、約45度の角度で横に振る]
- **角度**：[具体的な角度、例：水平から約45度上向き、体の中心線から約90度横]
- **スピード**：[具体的な数値または比較、例：0.30秒で打ち抜く、平均的なミドルキックの1.3倍の速度]
- **威力**：[具体的な数値または比較、例：体重の1.6倍の力で打つ、平均的なミドルキックの1.2倍の威力]
- **体重移動**：[具体的な記述、例：腰を約45度回転させ、前足に体重を70%移動させる]
- **脚の軌道**：[具体的な記述、例：膝を約90度曲げ、腰を約45度回転させ、約45度の角度で横に振る]
- **特徴的な動き**：[具体的な記述、例：ミドルキックを打つ際に、腰を大きく回転させる癖がある]

### ハイキック
- **フォーム**：[具体的な記述、例：膝を約90度曲げ、腰を約60度回転させ、約60度の角度で上に振る]
- **角度**：[具体的な角度、例：水平から約60度上向き、体の中心線から約90度横]
- **スピード**：[具体的な数値または比較、例：0.35秒で打ち抜く、平均的なハイキックの1.1倍の速度]
- **威力**：[具体的な数値または比較、例：体重の1.4倍の力で打つ、平均的なハイキックの1.0倍の威力]
- **体重移動**：[具体的な記述、例：腰を約60度回転させ、前足に体重を65%移動させる]
- **脚の軌道**：[具体的な記述、例：膝を約90度曲げ、腰を約60度回転させ、約60度の角度で上に振る]
- **特徴的な動き**：[具体的な記述、例：ハイキックを打つ際に、体を大きく後ろに傾ける癖がある]

### ローキック
- **フォーム**：[具体的な記述、例：膝を約60度曲げ、腰を約30度回転させ、約30度の角度で下に振る]
- **角度**：[具体的な角度、例：水平から約30度下向き、体の中心線から約90度横]
- **スピード**：[具体的な数値または比較、例：0.28秒で打ち抜く、平均的なローキックの1.2倍の速度]
- **威力**：[具体的な数値または比較、例：体重の1.5倍の力で打つ、平均的なローキックの1.1倍の威力]
- **体重移動**：[具体的な記述、例：腰を約30度回転させ、前足に体重を75%移動させる]
- **脚の軌道**：[具体的な記述、例：膝を約60度曲げ、腰を約30度回転させ、約30度の角度で下に振る]
- **特徴的な動き**：[具体的な記述、例：ローキックを打つ際に、体を少し前に傾ける癖がある]

## 4. フットワークの詳細分析

### 前後の動き
- **前進の仕方**：[具体的な記述、例：前足を約30cm前に出し、後足を約20cm前に出す、この動作を0.3秒で行う]
- **後退の仕方**：[具体的な記述、例：後足を約30cm後ろに引き、前足を約20cm後ろに引く、この動作を0.3秒で行う]
- **前後の動きのスピード**：[具体的な数値、例：1秒間に約3回前後に動く]
- **前後の動きの特徴**：[具体的な記述、例：小刻みに前進し、相手との距離を詰める]

### 左右の動き
- **左への動き**：[具体的な記述、例：左足を約40cm左に移動し、右足を約30cm左に移動、この動作を0.4秒で行う]
- **右への動き**：[具体的な記述、例：右足を約40cm右に移動し、左足を約30cm右に移動、この動作を0.4秒で行う]
- **左右の動きのスピード**：[具体的な数値、例：1秒間に約2回左右に動く]
- **左右の動きの特徴**：[具体的な記述、例：左右にステップして、相手の攻撃をかわす]

### ステップの仕方
- **ステップの種類**：[具体的な記述、例：シャッフルステップ、クロスステップ]
- **ステップのスピード**：[具体的な数値、例：1秒間に約4回ステップする]
- **ステップの特徴**：[具体的な記述、例：ステップが非常に軽快で、リズムを作る]

### 距離感の取り方
- **距離感の取り方**：[具体的な記述、例：前後の動きとステップで距離をコントロール、常に相手から約1.5mの距離を保つ]
- **距離感の調整方法**：[具体的な記述、例：相手との距離を常に意識し、最適な距離を保つ]
- **距離感の特徴**：[具体的な記述、例：距離感が非常に良く、距離感を活かしてカウンターを打つ]

### ポジショニング
- **ポジショニングの特徴**：[具体的な記述、例：常に最適なポジションを取る、相手の死角に入る]
- **ポジショニングの戦術的な使い方**：[具体的な記述、例：ポジショニングで相手をコントロール、ポジショニングでカウンターの機会を作る]

## 5. 防御技術の詳細分析

### ガードの仕方
- **ガードの位置**：[具体的な記述、例：両手を約15cm前に出し、約20cm上に上げる]
- **ガードの形**：[具体的な記述、例：ハイガード、両手を高く上げて防御]
- **ガードの特徴**：[具体的な記述、例：ガードが非常に堅く、ガードで頭部を守る]

### 回避の仕方
- **スウェイ**：[具体的な記述、例：頭を約20cm後ろに引いて攻撃をかわす、この動作を0.2秒で行う]
- **ダッキング**：[具体的な記述、例：腰を約30cm落として攻撃をかわす、この動作を0.25秒で行う]
- **サイドステップ**：[具体的な記述、例：左右に約40cmステップして攻撃をかわす、この動作を0.3秒で行う]
- **その他の回避方法**：[具体的な記述、例：ロール（体を約90度回転させて攻撃をかわす）、パーリング（手で相手のパンチを約30度の角度で払う）]

### 防御のタイミング
- **防御のタイミング**：[具体的な記述、例：相手の攻撃を約0.1秒前に予測して防御]
- **防御のタイミングの特徴**：[具体的な記述、例：防御のタイミングが完璧で、防御からカウンターへの切り替えが速い]

### 防御からカウンターへの切り替え
- **カウンターの使い方**：[具体的な記述、例：相手の攻撃をかわした直後、約0.2秒以内にカウンターを打つ]
- **カウンターのタイミング**：[具体的な記述、例：相手の攻撃をかわした瞬間にカウンター]
- **カウンターの特徴**：[具体的な記述、例：カウンターの精度が非常に高く、カウンターの威力が強い]

## 6. 癖や特徴的な動きの詳細分析

### 特徴的な動きや癖
- **パンチを打つ前の動き**：[具体的な記述、例：ストレートを打つ前に、わずかに頭を約5cm下げる癖がある]
- **キックを打つ前の動き**：[具体的な記述、例：ミドルキックを打つ前に、腰を約10度回転させる癖がある]
- **防御の際の動き**：[具体的な記述、例：防御する前に、ガードを約5cm高く上げる癖がある]
- **その他の特徴的な動き**：[具体的な記述、例：リズムを作るためにステップを多用、カウンターを打つ際に、わずかに体を約10cm後ろに引く]

### よく使うコンビネーション
- **コンビネーション1**：[具体的な記述、例：1-2-3（ストレート→ストレート→フック）、各パンチの間隔は約0.2秒、このコンビネーションを約0.6秒で打つ]
- **コンビネーション2**：[具体的な記述、例：1-2-左フック→右ストレート、各パンチの間隔は約0.25秒、このコンビネーションを約1.0秒で打つ]
- **コンビネーション3**：[具体的な記述、例：左フック→右ストレート→左フック、各パンチの間隔は約0.2秒、このコンビネーションを約0.6秒で打つ]

### 試合運びの特徴
- **試合の序盤**：[具体的な記述、例：距離を測り、相手の動きを観察、約30秒間は攻撃を控える]
- **試合の中盤**：[具体的な記述、例：カウンターで相手を圧倒、約1分間で約10回のカウンターを打つ]
- **試合の終盤**：[具体的な記述、例：コンビネーションで相手を仕留める、約30秒間で約5回のコンビネーションを打つ]

### 心理的な特徴
- **冷静さ**：[具体的な記述、例：非常に冷静で、感情的にならない、試合中に感情の起伏が少ない]
- **集中力**：[具体的な記述、例：集中力が高く、常に相手を観察、約90%の時間を相手の動きに集中]
- **自信**：[具体的な記述、例：自信に満ちており、自分の技術を信じている、試合中に自信を示す仕草が多い]

## 7. 総合的なスタイルの詳細分析

### 攻撃スタイル
- **攻撃的なスタイルか、カウンター重視か**：[具体的な記述、例：カウンター重視だが、攻撃的でもある、攻撃の約60%がカウンター]
- **攻撃のタイミング**：[具体的な記述、例：相手の攻撃をかわした直後、約0.2秒以内に攻撃]
- **攻撃の特徴**：[具体的な記述、例：カウンターストレートが特に鋭く、コンビネーションで相手を圧倒]

### 試合運び
- **戦術的な試合運びか、本能的な試合運びか**：[具体的な記述、例：戦術的な試合運び、試合の約80%を戦術的に運ぶ]
- **試合運びの特徴**：[具体的な記述、例：距離をコントロールして、カウンターで相手を圧倒、コンビネーションで相手を仕留める]

### スタンドとグラウンド
- **スタンド重視か、グラウンド重視か**：[具体的な記述、例：スタンド重視、試合の約90%をスタンドで戦う]
- **スタンドとグラウンドの使い分け**：[具体的な記述、例：スタンドで距離をコントロールし、グラウンドで仕留める]

## 8. ユーザーとの比較に使用する特徴的な動きのリスト

以下の動きが観察された場合、この選手に似ていると判断できる：

### パンチ関連
- [ ] ストレートを打つ前に、わずかに頭を下げる → この選手の特徴
- [ ] ストレートの軌道が、水平から約8度上向き → この選手の特徴
- [ ] フックを打つ際に、腰を約30度回転させる → この選手の特徴
- [ ] コンビネーションのスピードが、3発を0.6秒で打つ → この選手の特徴

### キック関連
- [ ] ミドルキックを打つ際に、腰を約45度回転させる → この選手の特徴
- [ ] ハイキックを打つ際に、体を大きく後ろに傾ける → この選手の特徴
- [ ] ローキックを打つ際に、体を少し前に傾ける → この選手の特徴

### フットワーク関連
- [ ] 前進の際に、前足を約30cm前に出し、後足を約20cm前に出す → この選手の特徴
- [ ] ステップのスピードが、1秒間に約4回ステップする → この選手の特徴
- [ ] 常に相手から約1.5mの距離を保つ → この選手の特徴

### 防御関連
- [ ] 防御する前に、ガードを約5cm高く上げる → この選手の特徴
- [ ] スウェイの際に、頭を約20cm後ろに引く → この選手の特徴
- [ ] カウンターのタイミングが、相手の攻撃をかわした直後、約0.2秒以内 → この選手の特徴

各項目について、動画の具体的なシーンを参照しながら、数値化できるものは数値で、比較可能なものは比較可能な形で詳細に記述してください。
```

### ステップ3：解析結果のテキスト化と整理

1. **解析結果の取得**
   - 動画解析ツールから出力されたテキストを取得
   - 必要に応じて、複数の動画の解析結果を統合
   - **重要**：複数の動画から得られた情報を統合し、より正確なデータを作成

2. **データの整理**
   - 解析結果を、拡張データベーステンプレートに合わせて整理
   - 重複や矛盾を確認し、修正
   - **重要**：「ユーザーとの比較に使用する特徴的な動きのリスト」を必ず作成

3. **データベースへの登録**
   - 整理したデータを、`Fighters_Database.md`に追加または更新
   - **重要**：各選手のデータに、「ユーザーとの比較に使用する特徴的な動きのリスト」を含める

## ユーザーの動きとの比較方法

### 比較の手順

1. **ユーザーの動画解析結果を取得**
   - ユーザーの動画を解析し、技術的特徴を抽出

2. **選手データベースと比較**
   - ユーザーの動きの特徴を、各選手の「ユーザーとの比較に使用する特徴的な動きのリスト」と照合
   - 一致する特徴が多い選手を特定

3. **類似度の計算**
   - 各選手との類似度を計算（例：10個の特徴のうち7個が一致 = 70%の類似度）
   - 類似度が高い選手を「似ている選手」として提示

4. **やる気を伸ばすための提示**
   - 「あなたの動きは、[選手名]に似ているわね！」と肯定的に提示
   - 「[選手名]を目指しているのね！素晴らしいわ！」と励ます
   - 「[選手名]の[技術名]を参考にしたら、もっと良くなるわよ」と具体的なアドバイスを提供

### 比較の例

**ユーザーの動きの特徴：**
- ストレートを打つ前に、わずかに頭を下げる
- ストレートの軌道が、水平から約8度上向き
- コンビネーションのスピードが、3発を0.6秒で打つ

**選手データベースとの照合：**
- 井上尚弥：3個の特徴が一致 → 70%の類似度
- 魔裟斗：1個の特徴が一致 → 30%の類似度

**提示方法：**
「あなたの動きは、井上尚弥に似ているわね！特に、ストレートの軌道とコンビネーションのスピードが似ているわ。井上尚弥を目指しているのね！素晴らしいわ！でも、フットワークは武尊を参考にしたら、もっと良くなるわよ。」

## 拡張されたデータベーステンプレート

詳細なテンプレートは、`Fighters_Database_Extended_Sample.md`を参照してください。

## 段階的なアプローチ

### フェーズ1：主要選手から開始（推奨）
1. 各格闘技から3-5名の主要選手を選定
2. 各選手について、代表的な試合動画を3-5本選定
3. 動画解析を実行し、データベースに登録
4. **重要**：各選手のデータに、「ユーザーとの比較に使用する特徴的な動きのリスト」を含める

### フェーズ2：データの拡充
1. フェーズ1で登録した選手のデータを、追加の動画で拡充
2. 他の選手についても、同様の手順でデータを追加
3. **重要**：ユーザーのフィードバックに基づいて、データを改善

### フェーズ3：継続的な更新
1. 新しい試合動画が公開されたら、定期的にデータを更新
2. ユーザーのフィードバックに基づいて、データを改善
3. **重要**：ユーザーの動きとの比較精度を向上させる

## 動画解析のコツ

1. **複数の動画を解析**
   - 1人の選手について、複数の試合動画を解析することで、より正確な情報が得られます
   - **重要**：同じ動きを複数の動画から確認し、一貫性を確認

2. **重要なシーンに焦点を当てる**
   - パンチ、キック、防御などの重要なシーンを重点的に解析
   - **重要**：各シーンの開始から終了までを詳細に分析

3. **時間をかけて確認**
   - 解析結果を、実際の動画と照らし合わせて確認
   - 必要に応じて、手動で修正や追加を行う
   - **重要**：数値化できるものは必ず数値で記録

4. **専門知識を活用**
   - 格闘技の専門知識を活用して、解析結果を補完
   - **重要**：ユーザーとの比較に使用できる特徴的な動きを特定

## 注意点

1. **著作権**
   - YouTubeなどの動画を使用する場合は、著作権に注意してください
   - 可能であれば、公式の動画を使用してください

2. **情報の正確性**
   - 動画解析の結果は、必ずしも100%正確ではありません
   - 専門知識を活用して、結果を検証してください
   - **重要**：複数の動画から得られた情報を統合し、より正確なデータを作成

3. **データの更新**
   - 選手の技術は、時間とともに変化する可能性があります
   - 定期的にデータを更新してください
   - **重要**：ユーザーの動きとの比較精度を向上させるため、継続的にデータを改善

## 次のステップ

1. 主要選手の動画を準備
2. Difyの動画解析機能または他の動画解析ツールを使用して解析
3. 解析結果を、拡張テンプレートに従って整理
4. **重要**：各選手のデータに、「ユーザーとの比較に使用する特徴的な動きのリスト」を含める
5. `Fighters_Database.md`に追加または更新
6. Difyのナレッジベースにアップロード
7. ユーザーの動画解析結果と比較し、類似度を計算
8. ユーザーのやる気を伸ばすための提示を行う
